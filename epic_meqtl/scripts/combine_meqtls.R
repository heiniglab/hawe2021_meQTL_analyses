#' -----------------------------------------------------------------------------
#' Combine EPIC meQTL categories.
#'
#' @author Johann Hawe <johann.hawe@helmholtz-muenchen.de>
#'
#' @date Wed Jan  08 14:32:38 2019
#' -----------------------------------------------------------------------------

# ------------------------------------------------------------------------------
print("Load libraries, set parameters.")
# ------------------------------------------------------------------------------
library(tidyverse)

# ------------------------------------------------------------------------------
print("Get snakemake params.")
# ------------------------------------------------------------------------------
fepic_cis <- snakemake@input$cis
fepic_longrange <- snakemake@input$longrange
fepic_trans <- snakemake@input$trans

# outputs
fout_combined <- snakemake@output[[1]]

# ------------------------------------------------------------------------------
print("Loading data..")
# ------------------------------------------------------------------------------
print("epic pairs")
epic_cis <- readRDS(fepic_cis)
epic_longrange <- readRDS(fepic_longrange)
epic_trans <- readRDS(fepic_trans)

# ------------------------------------------------------------------------------
print("Combining.")
# ------------------------------------------------------------------------------
epic_combined <- bind_rows(epic_cis, epic_trans, epic_longrange)

# ------------------------------------------------------------------------------
print("Saving results.")
# ------------------------------------------------------------------------------
saveRDS(epic_combined, fout_combined)

# ------------------------------------------------------------------------------
print("SessionInfo:")
# ------------------------------------------------------------------------------
sessionInfo()
